<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content="司大伟">
  <meta name="dcterms.date" content="2016-06-25">
  <title>Python编码规范</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="reveal.js/css/reveal.css">
  <style type="text/css">code{white-space: pre;}</style>

<!-- For syntax highlighting -->
  <link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">

  <link rel="stylesheet" href="reveal.js/css/theme/beige.css" id="theme">
  <!-- Printing and PDF exports -->
  <script>
    var link = document.createElement( 'link' );
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match( /print-pdf/gi ) ? 'reveal.js/css/print/pdf.css' : 'reveal.js/css/print/paper.css';
    document.getElementsByTagName( 'head' )[0].appendChild( link );
  </script>
  <!--[if lt IE 9]>
  <script src="reveal.js/lib/js/html5shiv.js"></script>
  <![endif]-->
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section>
  <h1 class="title">Python编码规范</h1>
  <h2 class="author">司大伟</h2>
  <h3 class="date">2016-06-25</h3>
</section>

<section><section id="概述" class="titleslide slide level1"><h1>概述</h1></section><section id="什么是pep8" class="slide level2">
<h1>什么是PEP8</h1>
<p>PEP = Python Enhancement Proposal</p>
<p>PEP8 = Style Guide for Python Code</p>
</section><section id="为什么要讲究代码规范" class="slide level2">
<h1>为什么要讲究代码规范</h1>
<p>Guido:</p>
<pre><code>Code is read much more often than it is written</code></pre>
</section><section id="什么时候不必遵守规范" class="slide level2">
<h1>什么时候不必遵守规范</h1>
<ul>
<li class="fragment">使得代码可读性变差</li>
<li class="fragment">破坏当前代码风格的连续性(比如历史原因)</li>
<li class="fragment">当代码需要保持向后兼容性</li>
</ul>
</section></section>
<section><section id="代码布局" class="titleslide slide level1"><h1>代码布局</h1></section><section id="缩进" class="slide level2">
<h1>缩进</h1>
<ul>
<li class="fragment">使用4个空格作为一级缩进</li>
<li class="fragment">不要混用Tab和空格</li>
<li class="fragment">设置编辑器将Tab转为空格</li>
</ul>
</section><section class="slide level2">

<h3 id="连续行的对齐">连续行的对齐</h3>
<p>被括号括起来的连续的长行, 比如函数定义/调用, 列表, 字典, 在换行时有两种对齐风格.</p>
<pre class="python"><code># 以括号为界, 垂直对齐.
foo = long_function_name(var_one, var_two,
                         var_three, var_four)
</code></pre>
<div class="fragment">
<p>一种是悬挂式缩进(hanging indent)</p>
<pre class="python"><code># 从括号起始就换行, 比正常的缩进多缩进一点以示区分.
def long_function_name(
        var_one, var_two, var_three,
        var_four):
    print(var_one)</code></pre>
</div>
</section><section class="slide level2">

<h3 id="不好的风格">不好的风格</h3>
<pre class="python"><code># 没有垂直对齐, 第一行参数就显得不突出.
foo = long_function_name(var_one, var_two,
    var_three, var_four)

# 和正常的函数体语句缩进一样, 不好区分.
def long_function_name(
    var_one, var_two, var_three,
    var_four):
    print(var_one)</code></pre>
<h3 id="if语句的缩进">IF语句的缩进</h3>
<p>当if语句后面的条件判断需要折行时, if占2个字符, 加上空格和左括号, 总共刚好是4个字符. 也就是说, 这时候如果是垂直对齐的话, 就和下面的语句缩进一样了, 例如:</p>
<pre class="python"><code># No extra indentation.
if (this_is_one_thing and
    that_is_another_thing):
    do_something()</code></pre>
</section><section class="slide level2">

<h3 id="if语句的缩进-1">IF语句的缩进</h3>
<pre class="python"><code># 添加一行注释, 这样在语法高亮的编辑器中会显得有所区别
# 但是pycharm中的pep8检测还是会提示
if (this_is_one_thing and
    that_is_another_thing):
    # Since both conditions are true, we can frobnicate.
    do_something()

# 增加额外的缩进.
if (this_is_one_thing
        and that_is_another_thing):
    do_something()</code></pre>
</section><section class="slide level2">

<h3 id="右括号的位置">右括号的位置</h3>
<p>多行语句中右括号(包括 圆括号,方括号,花括号)的位置也有两种情况</p>
<pre class="python"><code># 和第一个非空字符对齐
my_list = [
    1, 2, 3,
    4, 5, 6,
    ]
result = some_function_that_takes_arguments(
    &#39;a&#39;, &#39;b&#39;, &#39;c&#39;,
    &#39;d&#39;, &#39;e&#39;, &#39;f&#39;,
    )</code></pre>
<pre class="python"><code># 置于行首
my_list = [
    1, 2, 3,
    4, 5, 6,
]
result = some_function_that_takes_arguments(
    &#39;a&#39;, &#39;b&#39;, &#39;c&#39;,
    &#39;d&#39;, &#39;e&#39;, &#39;f&#39;,
)</code></pre>
</section><section class="slide level2">

<h3 id="二元运算符的位置">二元运算符的位置</h3>
<pre class="python"><code># No: 运算符和运算对象离得太远了
income = (gross_wages +
          taxable_interest +
          (dividends - qualified_dividends) -
          ira_deduction -
          student_loan_interest)</code></pre>
<pre class="python"><code># Yes: 运算符和运算对象很容易匹配
income = (gross_wages
          + taxable_interest
          + (dividends - qualified_dividends)
          - ira_deduction
          - student_loan_interest)</code></pre>
</section><section id="空行" class="slide level2">
<h1>空行</h1>
<ul>
<li class="fragment">顶层的函数和类定义之间用两个空行隔开</li>
<li class="fragment">类中的方法定义之间用一个空行隔开</li>
<li class="fragment">使用额外的空行来区分某组相关联的函数(保守使用)</li>
<li class="fragment">在函数中也可以用空行分隔不同的逻辑段(保守使用)</li>
<li class="fragment">连续的单行语句之间的空行可以省略</li>
</ul>
</section><section id="源文件编码" class="slide level2">
<h1>源文件编码</h1>
<ul>
<li class="fragment">Python2中默认的编码是ASCII</li>
<li class="fragment">Python3中默认的编码是UTF-8</li>
<li class="fragment">使用默认编码的无需编码声明</li>
</ul>
</section><section id="模块导入" class="slide level2">
<h1>模块导入</h1>
<p>import语句一般都要独占一行</p>
<pre class="python"><code>Yes: import os
     import sys

No:  import sys, os</code></pre>
<p>但是下面这种也可以接受</p>
<pre class="python"><code>from subprocess import Popen, PIPE</code></pre>
</section><section class="slide level2">

<h3 id="import语句的顺序">import语句的顺序</h3>
<p>import 语句一般总是在文件的上方, 接在模块注释和Docstring的后面, 在模块全局变量和常量之前.</p>
<p>import 语句应该遵从下面的顺序:</p>
<ol type="1">
<li class="fragment">标准库</li>
<li class="fragment">第三方库</li>
<li class="fragment">当前应用/库</li>
</ol>
</section><section class="slide level2">

<h3 id="绝对路径import">绝对路径import</h3>
<p>推荐使用绝对路径的import语句, 因为可读性更好.</p>
<p>当import出现问题时, 绝对路径可以提供更多的错误信息</p>
<pre class="python"><code>import mypkg.sibling
from mypkg import sibling
from mypkg.sibling import example</code></pre>
</section><section class="slide level2">

<h3 id="显式相对路径import">显式相对路径import</h3>
<p>当情况比较复杂时, <em>显式</em> 相对路径import也是可以的.</p>
<pre class="python"><code>from . import sibling
from .sibling import example</code></pre>
<p>避免使用隐式相对路径import, 这种方式在Python3中已经被淘汰.</p>
<!-- 隐式import的例子 -->
</section><section class="slide level2">

<h3 id="从模块中import类">从模块中import类</h3>
<p>可以直接import类</p>
<pre class="python"><code>from myclass import MyClass
from foo.bar.yourclass import YourClass</code></pre>
<p>如果要引入的类名和本地名称冲突, 也可以这样:</p>
<pre class="python"><code>import myclass
import foo.bar.yourclass

obj = myclass.MyClass()</code></pre>
</section><section class="slide level2">

<h3 id="避免使用import">避免使用import *</h3>
<p>尽量避免使用import *语句, 这样会造成本地命名空间不清晰, 对阅读代码以及一些自动化处理工具都会造成困扰.</p>
<p>只有一种例外的情况:</p>
<pre><code>当需要把内部接口重新发布为外部接口</code></pre>
</section><section id="module中的特殊变量" class="slide level2">
<h1>module中的特殊变量</h1>
<pre class="python"><code>&quot;&quot;&quot;This is the example module.

This module does stuff.
&quot;&quot;&quot;

from __future__ import barry_as_FLUFL

__all__ = [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]
__version__ = &#39;0.1&#39;
__author__ = &#39;Cardinal Biggles&#39;

import os
import sys</code></pre>
</section></section>
<section><section id="空白" class="titleslide slide level1"><h1>空白</h1></section><section id="不能加空格" class="slide level2">
<h1>不能加空格</h1>
<p>括号内部两边紧挨着括号的地方不要有空格</p>
<pre class="python"><code>Yes: spam(ham[1], {eggs: 2})
No:  spam( ham[ 1 ], { eggs: 2 } )</code></pre>
<div class="fragment">
<p>冒号, 逗号, 分号的前面不要有空格</p>
<pre class="python"><code>Yes: if x == 4: print x, y; x, y = y, x
No:  if x == 4 : print x , y ; x , y = y , x</code></pre>
</div>
</section><section class="slide level2">

<h3 id="切片语句中的冒号">切片语句中的冒号</h3>
<p>切片语句中, 冒号的作用类似于二元运算符, 在某些情况下可以在两边有对等的空格</p>
<pre class="python"><code>ham[1:9], ham[1:9:3], ham[:9:3], ham[1::3], ham[1:9:]
ham[lower:upper], ham[lower:upper:], ham[lower::step]
ham[lower+offset : upper+offset]
ham[: upper_fn(x) : step_fn(x)], ham[:: step_fn(x)]
ham[lower + offset : upper + offset]</code></pre>
</section></section>
<section><section id="注释" class="titleslide slide level1"><h1>注释</h1></section></section>
<section><section id="命名" class="titleslide slide level1"><h1>命名</h1></section></section>
<section><section id="编码建议" class="titleslide slide level1"><h1>编码建议</h1></section></section>
    </div>
  </div>

  <script src="reveal.js/lib/js/head.min.js"></script>
  <script src="reveal.js/js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({

        // Optional reveal.js plugins
        dependencies: [
          { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true },
          { src: 'reveal.js/plugin/notes/notes.js', async: true },
          { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
        ]
      });
    </script>
    </body>
</html>
